function r(a){let e,t,n,i,l,o;return e=a.toString().replace(/[^,\d]/g,""),t=e.split(","),n=t[0].length%3,i=t[0].substr(0,n),l=t[0].substr(n).match(/\d{3}/gi),l&&(o=n?".":"",i+=o+l.join(".")),i}function s(a,e){let t=!0;$(a).each(function(){if($(this).val().trim()==="")return t=!1,!1}),$(e).prop("disabled",!t)}$("#form_item").on("input",function(){s("#form_item input",".simpan_barang")});$(document).on("click","#add_item",function(a){a.preventDefault(),$("#form_item")[0].reset(),$(".modal-title span").text("Tambah Barang"),$(".modal-title i").removeClass("fas fa-edit").addClass("fas fa-box"),$("#action span").text("Simpan"),$("#action i").removeClass("fas fa-edit").addClass("fas fa-save"),$("#form_item").attr("action","/list-item/store"),$("input[name='_method']").remove(),$(".simpan_barang").prop("disabled",!0)});$(document).on("click","#keluar, .close",function(a){a.preventDefault(),$("#form_item").length&&$("#form_item")[0].reset(),$("input[name='_method']").remove(),$("#form_item").attr("action","#"),$("#import_s").length&&$("#import_s")[0].reset(),$("#preview").attr("src","assets/icon/iconupload.jpg"),$("#file-name").text("File not found")});$(document).on("input","#keyword",function(a){a.preventDefault();let e=$(this).val();e===""?$("tbody#tableBarang").load(`/item/search?query=${encodeURIComponent(e)}`,function(){window.history.pushState({},"","/list-item")}):$("tbody#tableBarang").load("/item/search?query="+encodeURIComponent(e),function(){$("tbody#tableBarang .nama-barang, .tipe-barang").each(function(){let t=$(this).text();if(e){let n=new RegExp("("+e+")","gi"),i=t.replace(n,'<span class="highlight">$1</span>');$(this).html(i)}else $(this).html(t)})})});$(document).on("click",".ubah",function(a){a.preventDefault();let e=$(this).data("id");$("#form_item")[0].reset(),$(".modal-title span").text("Ubah Data Barang"),$(".modal-title i").removeClass("fas fa-plus-square").addClass("fas fa-edit"),$("#action span").text("Ubah"),$("#action i").removeClass("fas fa-save").addClass("fas fa-edit"),$("#form_item").prepend('<input type="hidden" name="_method" value="PUT">'),$("#form_item").attr("action","/list-item/update/"+e),$(".simpan_barang").prop("disabled",!1),$.getJSON("/list-item/show/"+e,function(t,n,i){$("#nama_brg").val(t.result.nama_barang),$("#tipe_brg").val(t.result.tipe_barang),$("#harga_brg").val(r(t.result.harga_barang))}),$.getJSON(`/list-item/update/${e}`,function(t){console.log(t.success)})});$(document).on("click",".hapus",function(){let a=$(this).data("id"),e=$(this).data("name-type"),t=$("#delete_item_"+a);Swal.fire({title:"Apakah kamu yakin?",text:`Data barang ${e} akan dihapus!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(n=>{n.isConfirmed&&t.submit()})});$(document).on("click","#delete_all",function(a){a.preventDefault();let e=$(".selected:checked"),t=$('meta[name="csrf-token"]').attr("content");Swal.fire({title:"Apakah Anda yakin?",text:`${e.length} Item yang dipilih akan dihapus!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(n=>{if(n.isConfirmed)if(e.length>0){let i=e.map(function(){return $(this).data("id")}).get();$.ajax({url:"/delete_all",type:"DELETE",data:{ids:i,_token:t},success:function(l){Swal.fire({position:"center",icon:"success",title:`${i.length} Item berhasil dihapus.`,showConfirmButton:!1,timer:1500}).then(()=>{location.reload()})},error:function(l){Swal.fire({icon:"error",title:"Terjadi kesalahan",text:"Saat menghapus item."})}})}else alert("Silakan pilih item yang ingin dihapus.")})});$(document).on("change","#offset",function(a){a.preventDefault();let e=$(this).val();$("tbody#tableBarang").load("/item/offset?offset="+e,function(t){$(this).html(t.table),$(".pagination").html(t.pagination)})});$(document).on("change","#imports",function(a){a.preventDefault();let e=a.target.files[0];if(e){let t=new FileReader;t.onload=function(n){$("#preview").attr("src","assets/icon/excel.png")},t.readAsDataURL(e)}$("#file-name").text(e.name)});$(document).on("click","#selectAll",function(){$(".selected").prop("checked",$(this).prop("checked"))});$(document).on("change",".selected,#selectAll",function(){$(".selected:checked").length>0?$("#delete_all").prop("disabled",!1):$("#delete_all").prop("disabled",!0)});$(document).on("keyup","#harga_brg",function(){let e=$(this).val().replace(/[^,\d]/g,"");$(this).val(r(e))});$(document).on("submit","#form_item",function(){let e=$("#harga_brg").val().replace(/\./g,"");$("#harga_brg").val(e)});
