function o(t){let e,a,s,n,i;return n=new Date(t),e=String(n.getDate()).padStart(2,"0"),a=String(n.getMonth()+1).padStart(2,"0"),s=n.getFullYear(),i=e+"/"+a+"/"+s,i}function u(t,e){let a=!0;$(t).find("input,select").each(function(){if($(this).val()==="")return a=!1,!1}),$(e).prop("disabled",!a)}$("#filter_date").on("input",function(){u("#filter_date",".act_filter")});$(document).on("click","#add_item_list",function(t){t.preventDefault(),$("#barangmasuk").length>0&&$("#barangmasuk")[0].reset(),$("#brg_masuk").length>0&&$("#brg_masuk")[0].reset(),$(".modal-title span").text("Tambah Barang Masuk"),$(".modal-title i").removeClass("fas fa-edit").addClass("fas fa-plus-square"),$("#aksi_brg_masuk span").text("Simpan"),$("#aksi_brg_masuk i").removeClass("fas fa-edit").addClass("fas fa-save"),$("#barangmasuk").attr("action","/barang_masuk/store"),$("input[name='_method']").remove()});$(document).on("click",".act_stok_close ,#act_stok_close,#act_close,#act_keluar",function(t){t.preventDefault(),$("#barangmasuk").length>0&&$("#barangmasuk")[0].reset(),$("#nama_barang").trigger("change"),$("input[name='_method']").remove(),$("#barangmasuk").attr("action","#"),$("#brg_masuk").length>0&&$("#brg_masuk")[0].reset(),$("#preview").attr("src","assets/icon/iconupload.jpg"),$("#file-name").text("File not found"),$("#update_form_stok").length>0&&$("#update_form_stok")[0].reset(),$("#update_form_stok").attr("action","#")});$(document).on("change","#nama_barang",function(t){t.preventDefault();let e=$(this).find(":selected"),a=e.data("id");$("#id_barang").val(a),$("#tipe_barang_masuk").val(e.data("type")??"-")});$("#jumlah_brg,#kode_barang_brg_masuk").on("input",function(){this.value=this.value.replace(/[^0-9]/g,"")});$(document).on("click","#add_item",function(t){t.preventDefault(),$("#form_item")[0].reset(),$("#brg_masuk").length>0&&$("#brg_masuk")[0].reset(),$("#barangmasuk").length>0&&$("#barangmasuk")[0].reset(),$("#filter_date").length>0&&$("#filter_date")[0].reset(),$(".modal-title span").text("Tambah Barang"),$(".modal-title i").removeClass("fas fa-edit").addClass("fas fa-box"),$("#aksi_brg_masuk span").text("Simpan"),$("#aksi_brg_masuk i").removeClass("fas fa-edit").addClass("fas fa-save"),$("#form_item").attr("action","/list-item/store"),$("input[name='_method']").remove()});$(document).on("click",".ubah_barang_masuk",function(t){t.preventDefault();let e=$(this).data("id");$("#barangmasuk").length>0&&$("#barangmasuk")[0].reset(),$(".modal-title span").text("Ubah Data Barang Masuk"),$(".modal-title i").removeClass("fas fa-plus-square").addClass("fas fa-edit"),$("#aksi_brg_masuk span").text("Ubah"),$("#aksi_brg_masuk i").removeClass("fas fa-save").addClass("fas fa-edit"),$("#barangmasuk").prepend('<input type="hidden" name="_method" value="PUT">'),$("#barangmasuk").attr("action","/barang_masuk/update/"+e),$.getJSON("/barang_masuk/detail/"+e,function(a,s,n){let i=a.result.id_barang;$("#id_barang").val(a.result.id_barang),$("#tgl_brg_masuk").val(a.result.tgl_brg_masuk),$("#no_warehouse").val(a.result.no_warehouse),$("#kode_barang_brg_masuk").val(a.result.kode_barang),$("#nama_barang").val(null),$("#nama_barang option").filter(function(){return $(this).data("id")==i}).prop("selected",!0),$("#nama_barang").trigger("change"),$("#tipe_barang_masuk").val(a.result.tipe_barang),$("#asal_gdg").val(a.result.asal_gudang),$("#jumlah_brg").val(a.result.jumlah_barang),$("#posisi_brg_masuk").val(a.result.posisi).trigger("change"),$("#status").val(a.result.status),$("#konsumen").val(a.result.nama_konsumen).val()!=="-"?$("#konsumen").prop("readonly",!1):$("#konsumen").prop("readonly",!0)})});$(document).on("click","#selectAllItem",function(){$(".selected_").prop("checked",$(this).prop("checked"))});$(document).on("change",".selected_,#selectAllItem",function(){$(".selected_:checked").length>0?$("#delete_all_brg_masuk").prop("disabled",!1):$("#delete_all_brg_masuk").prop("disabled",!0)});$(document).on("click","#delete_all_brg_masuk",function(t){t.preventDefault();let e=$(".selected_:checked"),a=$('meta[name="csrf-token"]').attr("content");Swal.fire({title:"Apakah Anda yakin?",text:`${e.length} Item yang dipilih akan dihapus!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(s=>{if(s.isConfirmed)if(e.length>0){let n=e.map(function(){return $(this).data("id")}).get();$.ajax({url:"/delete/barang_masuk",type:"DELETE",data:{ids:n,_token:a},success:function(i){Swal.fire({position:"center",icon:"success",title:`${n.length} Item berhasil dihapus.`,showConfirmButton:!1,timer:1500}).then(()=>{location.reload()})},error:function(i){Swal.fire({icon:"error",title:"Terjadi kesalahan",text:"Saat menghapus item."})}})}else alert("Silakan pilih item yang ingin dihapus.")})});$(document).on("click",".hapus_brg_masuk",function(){let t=$(this).data("id"),e=$(this).data("date"),a=$(this).data("name-type"),s=$("#delete_items_"+t);Swal.fire({title:"Apakah kamu yakin?",text:`Barang tanggal ${o(e)} ${a} ini akan dihapus!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(n=>{n.isConfirmed&&s.submit()})});$(document).on("change","#status",function(t){t.preventDefault(),$(this).val()=="customer"?$("#konsumen").prop("readonly",!1).val(""):$("#konsumen").prop("readonly",!0).val("-")});$(document).on("input","#keyword_brg_masuk",function(t){t.preventDefault();let e=$(this).val(),a=$('meta[name="csrf-token"]').attr("content"),s;e?s="/barang_masuk/search":s="/barang_masuk/filter",$.ajax({type:"GET",url:s,data:{itemInQuery:e,_token:a,barangMasukLimit:10},success:function(n){e?($("tbody#tableBarangMasuk").html(n.table),$(".pagination-wrapper").html(n.pagination),$("#info-barang_masuk-page").html(`Menampilkan <b>${n.info.firstItem??0}</b> sampai <b>${n.info.lastItem??0}</b> dari <b>${n.info.total??0}</b> item`),$("tbody#tableBarangMasuk .nama_brg_masuk, .tipe_brg_masuk").each(function(){let i=$(this).text();if(e){let r=new RegExp("("+e+")","gi"),l=i.replace(r,'<span class="highlight">$1</span>');$(this).html(l)}else $(this).html(i)})):($("tbody#tableBarangMasuk").html(n.table),$(".pagination-wrapper").html(n.pagination),$("#info-barang_masuk-page").html(`Menampilkan <b>${n.info.firstItem??0}</b> sampai <b>${n.info.lastItem??0}</b> dari <b>${n.info.total??0}</b> item`))}})});$(document).on("change","#filter_brg_masuk",function(){let t=$(this).val(),e=$('meta[name="csrf-token"]').attr("content");$.ajax({type:"GET",url:"/barang_masuk/filter",data:{barangMasukLimit:t,_token:e},success:function(a){$("tbody#tableBarangMasuk").html(a.table),$(".pagination-wrapper").html(a.pagination),$("#info-barang_masuk-page").html(`Menampilkan <b>${a.info.firstItem??0}</b> sampai <b>${a.info.lastItem??0}</b> dari <b>${a.info.total??0}</b> item`)}})});$(document).on("click",".pagination a",function(t){t.preventDefault();let e=$(this).attr("href"),a=$("#filter_brg_masuk").val();e=new URL(e),e.searchParams.set("barangMasukLimit",a),$.ajax({url:e.toString(),type:"GET",success:function(s){$("tbody#tableBarangMasuk").html(s.table),$(".pagination-wrapper").html(s.pagination),$("#info-barang_masuk-page").html(`Menampilkan <b>${s.info.firstItem??0}</b> sampai <b>${s.info.lastItem??0}</b> dari <b>${s.info.total??0}</b> item`)}})});$(document).on("change","#import_brg_masuk",function(t){let e=t.target.files[0];if(e){let a=new FileReader;a.onload=function(s){$("#preview").attr("src","assets/icon/excel.png")},a.readAsDataURL(e)}$("#file-name").text(e.name)});$(document).on("click","#export_barang_masuk",function(t){t.preventDefault(),$("#barangmasuk").length>0&&$("#barangmasuk")[0].reset(),$("#brg_masuk").length>0&&$("#brg_masuk")[0].reset(),$("#filter_date").length>0&&$("#filter_date")[0].reset(),$(".modal-title span").text("Export File"),$(".modal-title i").removeClass("fas fa-edit"),$(".modal-title i").removeClass("fas fa-plus-square"),$(".modal-title i").addClass("fas fa-download")});$(document).on("click","#set_brg_masuk",function(t){t.preventDefault();let e=$("#start_date_brg_masuk").val(),a=$("#end_date_brg_masuk").val();$.ajax({type:"POST",url:"/barang_masuk/filter/date",data:{_token:$('meta[name="csrf-token"]').attr("content"),start_date:e,end_date:a},success:function(s){$("tbody").html(s),$(".pagination").html(s.pagination)},error:function(s){if(s.status===422){let n=s.responseJSON.errors,i="";n.start_date&&(i+=n.start_date[0]+"<br>"),n.end_date&&(i+=n.end_date[0]+"<br>"),Swal.fire({icon:"warning",title:"Validasi tanggal gagal",confirmButtonText:"OK"})}}})});$(document).on("click","#import_item_list",function(t){t.preventDefault(),$("#barangmasuk").length>0&&$("#barangmasuk")[0].reset(),$("#brg_masuk").length>0&&$("#brg_masuk")[0].reset(),$("#filter_date").length>0&&$("#filter_date")[0].reset(),$(".modal-title span").text("Upload File"),$(".modal-title i").removeClass("fas fa-edit"),$(".modal-title i").removeClass("fas fa-plus-square"),$(".modal-title i").addClass("fas fa-file-upload")});$("#filter_brg_masuk").val(10).trigger("change");
