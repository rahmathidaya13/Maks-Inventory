function d(){$(document).ready(function(){function l(t){let a,o,e,n,i;return n=new Date(t),a=String(n.getDate()).padStart(2,"0"),o=String(n.getMonth()+1).padStart(2,"0"),e=n.getFullYear(),i=a+"-"+o+"-"+e,i}$(document).on("click","#select_all_stok",function(){$(".selected").prop("checked",$(this).prop("checked"))}),$(document).on("change",".selected,#select_all_stok",function(){$(".selected:checked").length>0?$("#delete_all_stok").prop("disabled",!1):$("#delete_all_stok").prop("disabled",!0)}),$(document).on("click","#delete_all_stok",function(t){t.preventDefault();let a=$(".selected:checked"),o=$('meta[name="csrf-token"]').attr("content");Swal.fire({title:"Apakah Anda yakin?",text:`${a.length} Item yang dipilih akan dihapus!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(e=>{if(e.isConfirmed)if(a.length>0){let n=a.map(function(){return $(this).data("id")}).get();$.ajax({url:"/delete/all/stok",type:"DELETE",data:{ids:n,_token:o},success:function(i){Swal.fire({position:"center",icon:"success",title:`${n.length} Item berhasil dihapus.`,showConfirmButton:!1,timer:1500}).then(()=>{location.reload()})},error:function(i){Swal.fire({icon:"error",title:"Terjadi kesalahan",text:"Saat menghapus item."})}})}else alert("Silakan pilih item yang ingin dihapus.")})}),$(document).on("click","#stok_out, #stok_close,#act_import_stok,#act_filter_keluar_stok,#act_filter_close_stok",function(t){t.preventDefault(),$("input[name='_method']").remove(),$("#stokBarangForm").attr("action","#"),$("#stokBarangForm")[0].reset(),$("#filter_date_stok")[0].reset(),$("#import_stok_file")[0].reset(),$("#preview").attr("src","assets/icon/iconupload.jpg"),$("#file-name").text("File not found")}),$(document).on("click","#add_stok_barang",function(t){t.preventDefault(),$("#stokBarangForm")[0].reset(),$("#filter_date_stok")[0].reset(),$("#import_stok_file")[0].reset(),$(".modal-title span").text("Buat Stok Baru"),$(".modal-title i").removeClass("fas fa-edit"),$(".modal-title i").removeClass("fas fa-download"),$(".modal-title i").addClass("fas fa-plus-square"),$("#stok_save span").text("Simpan"),$("#stok_save i").removeClass("fas fa-edit").addClass("fas fa-save"),$("#stokBarangForm").attr("action","/stok/store"),$("input[name='_method']").remove(),$("#tgl").attr("readonly",!1),$(".nama_barang").css({pointerEvents:"all"})}),$(document).on("change","#nama_barang",function(){let t=$(this).find("option:selected"),a=t.data("type");t.data("id");let o=t.data("first-stok"),e=t.data("last-stok"),n=t.data("stok-in"),i=t.data("stok-out");$("#tipe_barang").val(a),$("#stok_awal").val(o??0),$("#stok_akhir").val(e??0),$("#brg_masuk").val(n??0),$("#brg_keluar").val(i??0)}),$(document).on("click",".ubah_stok",function(t){t.preventDefault(),Swal.fire({icon:"warning",title:"Ingin melakukan perubahan?",text:"Mengubah data ini dapat berdampak besar pada nilai yang ada. Pastikan kamu benar-benar yakin sebelum melanjutkan! Tindakan ini tidak dapat dibatalkan.",showCancelButton:!0,cancelButtonText:"Batal",cancelButtonColor:"#c82333",confirmButtonText:"Ya, Tetap ubah"}).then(a=>{if(a.isConfirmed){$("#staticBackdrop_stok_barang").modal("show"),$(".stok_out,.stok_close").click(function(e){e.preventDefault(),$("#staticBackdrop_stok_barang").modal("hide")});let o=$(this).data("id");$("#stokBarangForm")[0].reset(),$("#filter_date_stok")[0].reset(),$("#import_stok_file")[0].reset(),$(".modal-title span").text("Ubah Data Stok"),$(".modal-title i").removeClass("fas fa-plus-square"),$(".modal-title i").removeClass("fas fa-download"),$(".modal-title i").addClass("fas fa-edit "),$("#stok_save span").text("Ubah"),$("#stok_save i").removeClass("fas fa-save").addClass("fas fa-edit"),$("#stokBarangForm").attr("action",`/stok/update/${o}`),$("#stokBarangForm").prepend('<input type="hidden" name="_method" value="PUT">'),$.getJSON(`/stok/detail/${o}`,function(e){let n=e.result.id_barang;$(".nama_barang").css({pointerEvents:"none"}),$("#id_barang").val(e.result.id_barang),$("#tgl").val(e.result.tanggal).attr("readonly",!0),$("#nama_barang").val(null),$("#nama_barang option").filter(function(){return $(this).data("id")==n}).prop("selected",!0),$("#nama_barang").trigger("change"),$("#tipe_barang").val(e.result.tipe_barang),$("#posisi_barang").val(e.result.posisi).trigger("change"),$("#jumlah_barang").val(e.result.stok_awal),$("#keterangan").val(e.result.keterangan)})}else a.isDenied&&Swal.fire("Changes are not saved","","info")})}),$(document).on("click",".hapus_stok",function(t){t.preventDefault();let a=$(this).data("id"),o=$(`#delete_stok_${a}`),n=$(this).data("stok-field").split("/"),i=l(n[0]);Swal.fire({title:"Apakah kamu yakin?",text:`Data  ${i+" / "+n[1]+" / "+n[2]+" / "+n[3]} Akan dihapus!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(s=>{s.isConfirmed&&o.submit()})}),$(document).on("change","#import_stok_form",function(t){let a=t.target.files[0];if(a){let o=new FileReader;o.onload=function(e){$("#preview").attr("src","assets/icon/excel.png")},o.readAsDataURL(a)}$("#file-name").text(a.name)}),$(document).on("change","#filter_stok",function(t){t.preventDefault();let a=$(this).val();$.ajax({type:"GET",url:"/stok/filter",cache:!0,data:{stokLimit:a},success:function(o){$("tbody#tableStokBarang").html(o.table),$(".pagination-wrapper-stok").html(o.pagination),$("#info-stok-page").html(`Menampilkan <b>${o.info.firstItem??0}</b> sampai <b>${o.info.lastItem??0}</b> dari <b>${o.info.total??0}</b> item`)}})}),$(document).on("click",".pagination a",function(t){t.preventDefault();let a=$(this).attr("href"),o=$("#filter_stok").val();a=new URL(a),a.searchParams.set("stokLimit",encodeURIComponent(o)),$.ajax({url:a.toString(),type:"GET",cache:!0,success:function(e){$("tbody#tableStokBarang").html(e.table),$(".pagination-wrapper-stok").html(e.pagination),$("#info-stok-page").html(`Menampilkan <b>${e.info.firstItem??0}</b> sampai <b>${e.info.lastItem??0}</b> dari <b>${e.info.total??0}</b> item`)}})}),$(document).on("input","#keyword_stok",function(t){t.preventDefault();let a=$(this).val(),o=$('meta[name="csrf-token"]').attr("content"),e;a?e="/stok/search":e="/stok/filter",$.ajax({method:"GET",url:e,data:{stokKeyword:a,_token:o,stokLimit:10},cache:!0,success:function(n){a?($("tbody#tableStokBarang").html(n.table),$(".pagination-wrapper-stok").html(n.pagination),$("#info-stok-page").html(`Menampilkan <b>${n.info.firstItem??0}</b> sampai <b>${n.info.lastItem??0}</b> dari <b>${n.info.total??0}</b> item`),$("tbody .posisi_barang,.nama_brg_stok, .tipe_brg_stok").each(function(){let i=$(this).text();if(a){let s=new RegExp("("+a+")","gi"),r=i.replace(s,'<span class="highlight">$1</span>');$(this).html(r)}else $(this).html(i)})):($("tbody#tableStokBarang").html(n.table),$(".pagination-wrapper-stok").html(n.pagination),$("#info-stok-page").html(`Menampilkan <b>${n.info.firstItem??0}</b> sampai <b>${n.info.lastItem??0}</b> dari <b>${n.info.total??0}</b> item`))}})}),$(document).on("click","#set_filter_stok",function(t){t.preventDefault();let a=$("#start_date_filter_stok").val(),o=$("#end_date_filter_stok").val();$.ajax({type:"POST",url:"/stok/filter/date",data:{_token:$('meta[name="csrf-token"]').attr("content"),start_date:a,end_date:o},success:function(e){$("tbody").html(e),$(".pagination").html(e.pagination)},error:function(e){if(e.status===422){let n=e.responseJSON.errors,i="";n.start_date&&(i+=n.start_date[0]+"<br>"),n.end_date&&(i+=n.end_date[0]+"<br>"),Swal.fire({icon:"warning",title:"Validasi tanggal gagal",confirmButtonText:"OK"})}}})}),$(document).on("click","#add_item",function(t){t.preventDefault(),$("#form_item")[0].reset(),$("#brg_masuk").length>0&&$("#brg_masuk")[0].reset(),$("#barangmasuk").length>0&&$("#barangmasuk")[0].reset(),$("#filter_date").length>0&&$("#filter_date")[0].reset(),$(".modal-title span").text("Tambah Barang"),$(".modal-title i").removeClass("fas fa-edit").addClass("fas fa-box"),$("#aksi_brg_masuk span").text("Simpan"),$("#aksi_brg_masuk i").removeClass("fas fa-edit").addClass("fas fa-save"),$("#form_item").attr("action","/list-item/store"),$("input[name='_method']").remove()}),$(document).on("click","#export_stok_barang",function(t){t.preventDefault(),$("#stokBarangForm")[0].reset(),$("#import_stok_file")[0].reset(),$("#filter_date_stok")[0].reset(),$(".modal-title span").text("Export File"),$(".modal-title i").removeClass("fas fa-edit"),$(".modal-title i").removeClass("fas fa-plus-square"),$(".modal-title i").addClass("fas fa-download")}),$(document).on("click","#import_stok",function(t){t.preventDefault(),$("#stokBarangForm")[0].reset(),$("#import_stok_file")[0].reset(),$("#filter_date_stok")[0].reset(),$(".modal-title span").text("Upload File"),$(".modal-title i").removeClass("fas fa-edit"),$(".modal-title i").removeClass("fas fa-plus-square"),$(".modal-title i").addClass("fas fa-download")}),$("#filter_stok").val(10).trigger("change")})}export{d as default};
